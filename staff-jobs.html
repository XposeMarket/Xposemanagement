<!doctype html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>My Jobs</title><link rel="stylesheet" href="styles.css"><link rel="stylesheet" href="components/supplierLinks.css"></head><body>
<header class="top">
  <div class="container row top row">
    <a class="brand" id="brandLink" href="dashboard.html" aria-label="Home">
      <img id="headerLogo" src="assets/XposeManagementCRMlogo.png" alt="Logo">
    </a>
    <button id="menuToggle" class="menu-toggle" aria-label="Toggle menu"><span></span><span></span><span></span></button><nav id="mainNav">
      <a href="staff-portal.html" class="staff-only-nav" style="display:none">Staff Portal</a>
      <a href="dashboard.html" class="owner-nav">Dashboard</a>
      <a href="appointments.html" class="">Appointments</a>
      <a href="foreman-appointments.html" class="foreman-nav" style="display:none">Job Board</a>
      <a href="claim-board.html" class="">Claim Board</a>
      <a id="jobsNavLink" href="jobs.html" class="">Jobs</a>
      <a href="staff-jobs.html" class="active">My Jobs</a>
      <a href="completed-jobs.html" class="staff-only-nav" style="display:none">Completed Jobs</a>
      <a href="messages.html" class="">Messages</a>
      <a href="invoices.html" class="">Invoices</a>
      <a href="customers.html" class="">Customers</a>
      <a href="revenue.html" class="owner-nav">Revenue</a>
      <a href="settings.html" class="owner-nav">Settings</a>
      <a href="profile.html" class="">Profile</a>
        <a href="#" id="mobileThemeToggle" class="mobile-nav-btn mobile-special">Theme</a>
        <a href="#" id="mobileLogoutBtn" class="mobile-nav-btn mobile-special">Logout</a>
    </nav>
    <div>
      <button id="themeToggle" class="btn" aria-label="Toggle theme">Theme</button>
      <button id="logoutBtn" class="btn" aria-label="Logout">Logout</button>
    </div>
  </div>
</header>
<div id="notification" class="notification hidden"></div>
<div id="errorBanner" class="notification hidden" style="background:#ef4444;color:white;"></div>
<main class="container" style="padding:16px 0">
  <!-- Header with title and Diagnostics button -->
  <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 12px; margin-bottom: 16px;">
    <h1 style="margin: 0;">My Jobs</h1>
    <button id="openDiagnosticsBtn" class="btn" style="background: linear-gradient(135deg, #8b5cf6 0%, #6d28d9 100%); color: white; padding: 10px 20px; font-size: 1rem; display: flex; align-items: center; gap: 8px;">
      <img src="/assets/cortex-mark.png" alt="Cortex" style="width:20px;height:20px;object-fit:contain;" />
      <span style="font-weight:700; font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; font-size: 1rem; letter-spacing: 0.2px;">Cortex</span>
    </button>
  </div>

<div class="card">
  <h3>Active Jobs (In progress)</h3>
  <table class="table" id="jobsTable">
    <thead><tr>
      <th style="width: 20px; padding: 0;"></th>
      <th>Job #</th>
      <th>Customer</th>
      <th>Vehicle</th>
      <th>Service</th>
      <th>Status</th>
      <th>Assigned To</th>
      <th>Actions</th>
    </tr></thead>
    <tbody></tbody>
  </table>
  <p class="notice" id="jobsEmpty"></p>
</div>

<div class="card" id="awaitWrap" style="margin-top:16px">
  <h3>Awaiting Parts</h3>
  <table class="table" id="awaitTable">
    <thead><tr>
      <th style="width: 20px; padding: 0;"></th>
      <th>Job #</th>
      <th>Customer</th>
      <th>Vehicle</th>
      <th>Service</th>
      <th>Status</th>
      <th>Assigned To</th>
      <th>Actions</th>
    </tr></thead>
    <tbody></tbody>
  </table>
  <p class="notice" id="awaitEmpty"></p>
</div>

<!-- Reuse jobs modals from jobs.html for consistency -->
<div id="jobViewModal" class="modal-overlay hidden" onclick="closeJobViewModal()">
  <div class="modal-content" onclick="event.stopPropagation()">
    <div class="modal-head">
      <h3>Job Details</h3>
      <button onclick="closeJobViewModal()" class="btn-close">&times;</button>
    </div>
    <div class="modal-body" id="jobViewContent"></div>
    <div class="modal-foot"><button onclick="closeJobViewModal()" class="btn">Close</button></div>
  </div>
</div>

<div id="jobNoteModal" class="modal-overlay hidden" onclick="closeJobNoteModal()" style="z-index: 10030;">
  <div class="modal-content" onclick="event.stopPropagation()" style="max-width: 600px;">
    <div class="modal-head">
      <h3 id="jobNoteModalTitle">Add Note</h3>
      <button onclick="closeJobNoteModal()" class="btn-close">&times;</button>
    </div>
    <div class="modal-body">
      <form id="jobNoteForm" style="display: flex; flex-direction: column; gap: 12px;">
        <label for="noteSubject">Subject (optional):</label>
        <input id="noteSubject" placeholder="Brief subject for this note" style="width:100%; padding:8px; border:1px solid #ddd; border-radius:4px;">

        <div style="margin-top:4px;">
          <label style="display:block; margin-bottom:6px;">Send To:</label>
          <div id="noteSendToPills" style="display:flex; gap:8px; flex-wrap:wrap;"></div>
        </div>

        <div style="display: flex; flex-direction: column; gap: 8px;">
          <label>Attachments (Images/Videos):</label>
          <div style="display: flex; align-items: center; gap: 12px;">
            <label for="jobNoteMedia" class="btn small" style="cursor: pointer; margin: 0;">Choose Files</label>
            <input type="file" id="jobNoteMedia" accept="image/*,video/*" multiple style="display: none;">
            <span id="jobNoteMediaCount" style="font-size: 13px; color: #666;">No files selected</span>
          </div>
          <div id="jobNoteMediaPreview" style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 4px;"></div>
        </div>

        <label for="jobNoteText">Note:</label>
        <textarea id="jobNoteText" rows="4" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; resize: vertical;" placeholder="Enter your note here..."></textarea>
      </form>
    </div>
    <div class="modal-foot">
      <button onclick="closeJobNoteModal()" class="btn">Cancel</button>
      <button onclick="saveJobNote(event)" class="btn info" id="saveJobNoteBtn">Save</button>
    </div>
  </div>
</div>

  <!-- Media Preview Modal -->
  <div id="mediaPreviewModal" class="modal-overlay hidden" onclick="closeMediaPreview()" style="z-index: 10050;">
    <div class="modal-content" onclick="event.stopPropagation()" style="max-width: 90vw; max-height: 90vh; padding: 0; background: #000; border-radius: 8px; overflow: hidden;">
      <button onclick="closeMediaPreview()" class="btn-close" style="position: absolute; top: 10px; right: 10px; z-index: 10; background: rgba(0,0,0,0.5); color: white; border-radius: 50%; width: 36px; height: 36px;">&times;</button>
      <div id="mediaPreviewContent" style="display: flex; justify-content: center; align-items: center; max-height: 85vh;"></div>
    </div>
  </div>

  <!-- Delete Note Confirmation Modal -->
  <div id="deleteNoteModal" class="modal-overlay hidden" onclick="closeDeleteNoteModal()" style="z-index: 10040;">
    <div class="modal-content" onclick="event.stopPropagation()" style="max-width: 400px;">
      <div class="modal-head">
        <h3>Delete Note</h3>
        <button onclick="closeDeleteNoteModal()" class="btn-close">&times;</button>
      </div>
      <div class="modal-body">
        <p>Are you sure you want to delete this note? This action cannot be undone.</p>
      </div>
      <div class="modal-foot">
        <button onclick="closeDeleteNoteModal()" class="btn">Cancel</button>
        <button onclick="confirmDeleteNote()" class="btn danger">Delete</button>
      </div>
    </div>
  </div>

</main>
<footer class="container">Â© Xpose Market</footer>
<script src="vendor/supabase.umd.js"></script>
<script type="module" src="app.js"></script>
<script src="multi-tenant.js"></script>
<script type="module" src="pages/jobs-staff.js"></script>
</body></html>
