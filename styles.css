/* Hide mainNav by default on mobile, show only when .active */
@media (max-width: 900px) {
  #mainNav {
    display: none;
  }
  #mainNav.active {
    display: block;
  }
}
/* Mobile-specific settings page panel order and spacing */
@media (max-width: 700px) {
  .container > .card,
  #invitations-section {
    margin-bottom: 16px !important;
  }
  .container > .card {
    width: 100%;
    max-width: 100%;
    box-sizing: border-box;
  }
  .grid.cols-2, .grid.cols-3 {
    grid-template-columns: 1fr !important;
  }
  #xm-team-card {
    margin-bottom: 16px !important;
  }
}
@media (max-width: 900px) {
  .threads-panel {
    width: 100vw !important;
    max-width: 100vw !important;
    flex: 1 1 100vw !important;
    border-radius: 0 !important;
    left: 0 !important;
    right: 0 !important;
  }
}
/* Profile page mobile/responsive layout */
.profile-main { padding: 16px 0; }
.profile-flex {
  display: flex;
  flex-direction: row;
  gap: 32px;
  align-items: flex-start;
  width: 100%;
}
#profileCardCol { flex: 1; min-width: 0; display: flex; flex-direction: column; justify-content: stretch; }
#profileCard { max-width: 600px; width: 100%; }
.profile-btn-row { margin-top: 10px; display: flex; gap: 8px; flex-wrap: wrap; }
#themePanel { max-width: 600px; width: 100%; padding: 20px 18px; display: flex; flex-direction: column; align-items: center; gap: 18px; align-self: stretch; margin-top: 85px; }
#themePanel h3 { margin-bottom: 8px; font-size: 1.1em; font-weight: 600; }
#themeSwatches { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; width: 100%; }
.theme-panel-note { font-size: 12px; color: var(--muted); margin-top: 8px; text-align: center; }

@media (max-width: 900px) {
  .profile-flex { flex-direction: column; gap: 18px; }
  #themePanel { margin-top: 0; max-width: 100%; min-width: 0; }
}
@media (max-width: 600px) {
  .profile-main { padding: 8px 0; }
  .profile-flex { gap: 10px; }
  #profileCard, #themePanel { padding: 12px 8px; }
  #themeSwatches { gap: 8px; }
  .theme-swatch { width: 48px !important; height: 32px !important; }
  .profile-btn-row { flex-direction: column; gap: 6px; }
}
/* Theme Picker Panel and Swatches */
#themePanel {
  box-shadow: 0 2px 12px rgba(0,0,0,0.06);
  max-width: 600px;
  width: 100%;
  background: var(--card);
  border: 1.5px solid var(--line);
  height: 100%;
}
#themePanel h3 {
  margin-bottom: 8px;
  font-size: 1.1em;
  font-weight: 600;
  color: var(--text);
}
#themeSwatches {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 14px;
  width: 100%;
}
.theme-swatch {
  width: 64px;
  height: 44px;
  border-radius: 10px;
  box-shadow: 0 1px 4px #0001;
  cursor: pointer;
  display: flex;
  overflow: hidden;
  border: 2px solid var(--line);
  transition: outline 0.15s, box-shadow 0.15s;
}
.theme-swatch:active {
  box-shadow: 0 2px 8px #0002;
}
.theme-swatch[style*='outline'] {
  z-index: 1;
}
@media (max-width: 900px) {
  #themePanel { max-width: 100%; min-width: 0; margin-top: 24px; }
  #themeSwatches { grid-template-columns: 1fr 1fr; }
}
/*
  Smooth modern dark theme: styled to match the new palette system
*/
:root.theme-dark {
  --bg: #181c23;
  --text: #e6eaf1;
  --muted: #7a8599;
  --card: #232834;
  --line: #2d3342;
  --accent: #4b90e2;
  --folder-bg: linear-gradient(180deg, var(--card), rgba(255,255,255,0.04));
  --folder-border: 1px dashed var(--line);
  --folder-blue-bg: linear-gradient(180deg, var(--card), rgba(240,249,255,0.04));
  --folder-blue-border: color-mix(in srgb, var(--line) 70%, #bfdbfe 30%);
  color-scheme: dark;
}

/*
  Landing Dark theme: matches the new landing pages (index, features, paywall, cortex)
  Deeper blacks with green/blue gradient accents
*/
:root.theme-landing {
  --bg: #070b12;
  --text: #eaf0ff;
  --muted: rgba(234,240,255,0.72);
  --card: rgba(255,255,255,0.05);
  --line: rgba(255,255,255,0.10);
  --accent: #22c55e;
  --accent-blue: #60a5fa;
  --folder-bg: linear-gradient(180deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02));
  --folder-border: 1px solid rgba(255,255,255,0.10);
  --folder-blue-bg: linear-gradient(180deg, rgba(96,165,250,0.08), rgba(255,255,255,0.02));
  --folder-blue-border: rgba(96,165,250,0.25);
  color-scheme: dark;
}

/* Landing theme enhancements - cards get subtle glow effects */
:root.theme-landing .card {
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.10);
  box-shadow: 0 18px 60px rgba(0,0,0,0.40);
}

:root.theme-landing .btn.info,
:root.theme-landing .btn.primary {
  background: linear-gradient(135deg, rgba(34,197,94,0.92), rgba(96,165,250,0.72));
  color: #05110a;
  border: 1px solid rgba(255,255,255,0.10);
}

:root.theme-landing body {
  background:
    radial-gradient(900px 500px at 18% 12%, rgba(96,165,250,0.18), rgba(0,0,0,0) 65%),
    radial-gradient(900px 500px at 82% 18%, rgba(34,197,94,0.16), rgba(0,0,0,0) 70%),
    radial-gradient(900px 500px at 60% 92%, rgba(245,158,11,0.10), rgba(0,0,0,0) 65%),
    linear-gradient(180deg, #070b12, #0b1020);
}

:root.theme-landing .main-header {
  background: rgba(7,11,18,0.65);
  backdrop-filter: blur(14px);
  box-shadow: none;
  border-bottom: 1px solid rgba(255,255,255,0.06);
}

:root.theme-landing input,
:root.theme-landing select,
:root.theme-landing textarea {
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.12);
  color: var(--text);
}

:root.theme-landing input:focus,
:root.theme-landing select:focus,
:root.theme-landing textarea:focus {
  border-color: rgba(96,165,250,0.5);
  outline: none;
}

:root.theme-landing .tag {
  background: rgba(255,255,255,0.08);
  border-color: rgba(255,255,255,0.15);
}

/* Landing theme status tags - solid backgrounds for readability */
:root.theme-landing .tag.open {
  background: #fee2e2 !important;
  color: #991b1b !important;
  border-color: #ef4444 !important;
}
:root.theme-landing .tag.scheduled {
  background: #e0ecff !important;
  color: #1e40af !important;
  border-color: #3b82f6 !important;
}
:root.theme-landing .tag.in_progress,
:root.theme-landing .tag.in-progress {
  background: #fef3c7 !important;
  color: #92400e !important;
  border-color: #f59e0b !important;
}
:root.theme-landing .tag.awaiting_parts,
:root.theme-landing .tag.awaiting-parts {
  background: #e0e7ff !important;
  color: #3730a3 !important;
  border-color: #6366f1 !important;
}
:root.theme-landing .tag.completed,
:root.theme-landing .tag.done {
  background: #dcfce7 !important;
  color: #065f46 !important;
  border-color: #10b981 !important;
}
:root.theme-landing .tag.paid {
  background: #dcfce7 !important;
  color: #065f46 !important;
  border-color: #10b981 !important;
}
:root.theme-landing .tag.unpaid,
:root.theme-landing .tag.pending {
  background: #fee2e2 !important;
  color: #991b1b !important;
  border-color: #ef4444 !important;
}
:root.theme-landing .tag.partial {
  background: #fef3c7 !important;
  color: #92400e !important;
  border-color: #f59e0b !important;
}
:root.theme-landing .tag.cancelled,
:root.theme-landing .tag.canceled {
  background: #f3f4f6 !important;
  color: #4b5563 !important;
  border-color: #9ca3af !important;
}

:root.theme-landing table th {
  background: rgba(255,255,255,0.03);
}

:root.theme-landing table tr:hover {
  background: rgba(255,255,255,0.04);
}

/* Landing theme modals - solid backgrounds for readability */
:root.theme-landing .modal,
:root.theme-landing .modal-content,
:root.theme-landing .modal-card,
:root.theme-landing .card.modal,
:root.theme-landing [class*="modal"] .card,
:root.theme-landing .modal .card,
:root.theme-landing #emailModal,
:root.theme-landing #passModal,
:root.theme-landing #confirmModal,
:root.theme-landing #invoiceModal,
:root.theme-landing #apptModal,
:root.theme-landing #jobModal,
:root.theme-landing #custModal,
:root.theme-landing #vehicleModal,
:root.theme-landing #messageModal,
:root.theme-landing #diagModal,
:root.theme-landing #inspectionModal,
:root.theme-landing #laborModal,
:root.theme-landing #partModal,
:root.theme-landing #statusModal,
:root.theme-landing #terminalModal,
:root.theme-landing #inviteModal,
:root.theme-landing #staffModal,
:root.theme-landing #paymentModal,
:root.theme-landing #refundModal,
:root.theme-landing #shopModal,
:root.theme-landing #newShopModal,
:root.theme-landing #editShopModal,
:root.theme-landing #logoutModal,
:root.theme-landing .confirm-modal,
:root.theme-landing .dialog,
:root.theme-landing [role="dialog"],
:root.theme-landing .card[style*="fixed"],
:root.theme-landing .card[style*="absolute"],
:root.theme-landing div[style*="fixed"].card,
:root.theme-landing div[style*="z-index"].card {
  background: #0d1117 !important;
  border: 1px solid rgba(255,255,255,0.12) !important;
  box-shadow: 0 25px 80px rgba(0,0,0,0.7) !important;
}

/* Modal backdrop should be darker too */
:root.theme-landing .modal-backdrop {
  background: rgba(0,0,0,0.85) !important;
}

/* Modal header and footer borders */
:root.theme-landing .modal-head,
:root.theme-landing .modal-foot {
  border-color: rgba(255,255,255,0.10) !important;
}

/* Ensure modal cards inside modals also get solid background */
:root.theme-landing .modal .card,
:root.theme-landing .modal-content .card {
  background: #0d1117 !important;
}

/* Landing theme sticky header - glassmorphism with blur for readability */
:root.theme-landing .main-header {
  background: rgba(7,11,18,0.75) !important;
  backdrop-filter: blur(16px);
  -webkit-backdrop-filter: blur(16px);
  border-bottom: 1px solid rgba(255,255,255,0.08);
  box-shadow: 0 4px 30px rgba(0,0,0,0.3);
}

:root.theme-landing header.main-header,
:root.theme-landing .topbar,
:root.theme-landing header[class*="header"] {
  background: rgba(7,11,18,0.75) !important;
  backdrop-filter: blur(16px);
  -webkit-backdrop-filter: blur(16px);
}

/* Force dark theme on all select elements */
:root.theme-dark select,
:root.theme-dark select option {
  background-color: var(--card) !important;
  color: var(--text) !important;
  color-scheme: dark;
}

/* Force landing theme on all select elements */
:root.theme-landing select,
:root.theme-landing select option {
  background-color: rgba(255,255,255,0.06) !important;
  color: var(--text) !important;
  color-scheme: dark;
}

/* Custom floating dropdown styling */
.custom-select-list.floating {
  background: var(--card) !important;
  color: var(--text) !important;
  border-color: var(--line) !important;
}
.custom-select-item:hover {
  background: var(--bg) !important;
}
/*
  Blue-grey theme: similar style to theme-alt, but with blue-grey tones
*/
:root.theme-bluegrey {
  --bg: #f4f6fa;
  --text: #1a2330;
  --muted: #6b7a8f;
  --card: #e6eaf1;
  --line: #b0b8c9;
  --accent: #4b6fa5;
}
/*
  Blue-hued theme: similar style to theme-alt, but with blue tones
*/
:root.theme-blue {
  --bg: #f3f8fd;
  --text: #183153;
  --muted: #5a6b8c;
  --card: #e3f0fa;
  --line: #a3c8e8;
  --accent: #3b82f6;
}
/*
  The new alternate theme replaces the old theme-alt.
  If you want to adjust the palette, do so here.
*/
:root.theme-alt {
  --bg: #f7fafc;
  --text: #183153;
  --muted: #6c7a89;
  --card: #eaf6fb;
  --line: #b5e3e8;
  --accent: #2ec4b6;
}
/* Add Labor pill: small, pill-shaped, matches status pill size */
.add-labor-pill {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 2px 10px;
  border-radius: 999px;
  border: 2px solid var(--line);
  font-size: 12px;
  min-width: 0;
  text-align: center;
  white-space: nowrap;
  height: 22px;
  font-weight: 500;
  background: #f3f4f6;
  color: #1e293b;
  margin-top: 2px;
  margin-bottom: 2px;
  cursor: pointer;
  transition: box-shadow 0.18s, border-color 0.18s, transform 0.14s, filter 0.12s;
}
.add-labor-pill:hover, .add-labor-pill:focus {
  border-color: var(--accent);
  box-shadow: 0 2px 12px rgba(16, 185, 129, 0.10);
  filter: brightness(0.98);
  transform: translateY(-2px) scale(1.04);
}
/* Remove button absolute right in invoice modal item row */
.inv-abs-remove {
  right: 0;
  top: 50%;
  position: absolute;
  transform: translateY(-50%);
  z-index: 2;
}
/* Ensure item row has enough right padding for the button */
.item-row {
  padding-right: 90px !important;
}
/* Tighter block spacing for add-labor pill */
.inv-item-block {
  margin-bottom: 2px;
}
.tag.open {
  background: #fee2e2;
  color: #991b1b;
  border-color: #ef4444;
}
.tag.scheduled {
  background: #e0ecff;
  color: #1e40af;
  border-color: #3b82f6;
}
.tag.in_progress {
  background: #fef3c7;
  color: #92400e;
  border-color: #f59e0b;
}
.tag.awaiting_parts {
  background: #e0e7ff;
  color: #3730a3;
  border-color: #6366f1;
}
.tag.completed, .tag.done {
  background: #dcfce7;
  color: #065f46;
  border-color: #10b981;
}
/* Status badge clickable style for all pages */
.tag {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 3px 10px;
  border-radius: 999px;
  border: 2px solid var(--line);
  font-size: 12px;
  min-width: 48px;
  text-align: center;
  white-space: nowrap;
  height: 22px;
  font-weight: 500;
  cursor: pointer;
  background: var(--card);
  transition: box-shadow 0.18s, border-color 0.18s, transform 0.14s, filter 0.12s;
}
.tag:hover, .tag:focus {
  border-color: var(--accent);
  box-shadow: 0 2px 12px rgba(16, 185, 129, 0.10);
  filter: brightness(0.98);
  transform: translateY(-2px) scale(1.04);
}
.dashboard-layout .btn.quick-create#btnNewAppt {
  background: #10b981;
  color: #fff;
  border: none;
  border-radius: 999px;
}
.dashboard-layout .btn.quick-create#btnNewInv {
  background: #f59e0b;
  color: #fff;
  border: none;
  border-radius: 999px;
}
.dashboard-layout .btn.quick-create#btnNewCust {
  background: #60a5fa;
  color: #fff;
  border: none;
  border-radius: 999px;
}
/* Customers: hide action buttons, vehicles, total, and last column on mobile; make rows clickable */
@media (max-width: 768px) {
  #custTable .cust-actions,
  #custTable th:last-child,
  #custTable td:last-child,
  #custTable .cust-veh,
  #custTable th:nth-child(4),
  #custTable .cust-total,
  #custTable th:nth-child(5),
  #custTable td:nth-child(5) {
    display: none !important;
  }
  #custTable tr.cust-row-clickable {
    cursor: pointer;
    transition: background 0.13s;
  }
  #custTable tr.cust-row-clickable:hover,
  #custTable tr.cust-row-clickable:active {
    background: #f3f4f6;
  }
}

/* Mobile condensed customer cell formatting */
@media (max-width: 768px) {
  #custTable td.cust-mobile-cell {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 100%;
  }
  /* Ensure the hidden trailing actions cell doesn't collapse the row height */
  #custTable td.cust-actions {
    display: none !important;
    width: 1px; /* keep a tiny cell so :last-child rules target it */
    padding: 0; margin: 0; border: none;
  }
}

/* Mobile-only nav links (visible inside the mobile dropdown) */
.mobile-nav-btn { display: none; }

/* Dashboard Day Details Table: mobile readability improvements */
@media (max-width: 768px) {
  #dayTable th, #dayTable td {
    font-size: 12px !important;
    padding: 6px 4px !important;
    white-space: normal !important;
    word-break: break-word;
  }
  #dayTable th, #dayTable td {
    min-width: 60px;
    max-width: 120px;
  }
  #dayTable {
    font-size: 12px !important;
    border-spacing: 0 2px;
  }
  #dayTable th {
    font-weight: 600;
  }
}
@media (max-width: 768px) {
  .mobile-nav-btn { display: block; padding: 8px 10px; }
}
/* Hide invoice number column on mobile */
@media (max-width: 768px) {
  #invTable th:first-child,
  #invTable td:first-child {
    display: none;
  }
}
/* Hide invoice row action buttons and number column on mobile (show only in modal) */
@media (max-width: 768px) {
  #invTable .appt-actions-grid,
  #prevTable .appt-actions-grid {
    display: none !important;
  }
  #invTable th:first-child,
  #invTable td:first-child,
  #prevTable th:first-child,
  #prevTable td:first-child {
    display: none;
  }
}
/* Jobs/Invoices: clickable row on mobile */
@media (max-width: 768px) {
  .job-row-clickable, .inv-row-clickable {
    cursor: pointer;
    transition: background 0.13s;
  }
  .job-row-clickable:hover, .job-row-clickable:active,
  .inv-row-clickable:hover, .inv-row-clickable:active {
    background: #f3f4f6;
  }
}
/* Appointments: clickable row on mobile */
@media (max-width: 768px) {
  .appt-row-clickable {
    cursor: pointer;
    transition: background 0.13s;
  }
  .appt-row-clickable:hover,
  .appt-row-clickable:active {
    background: #f3f4f6;
  }
}
/* Completed Jobs: on small screens, show only Customer, Vehicle, Service columns */
@media (max-width: 640px) {
  /* Hide header columns we don't want on mobile (Job #, Completed By, Completed At, Actions) */
  #completedJobsTable thead th:nth-child(1),
  #completedJobsTable thead th:nth-child(5),
  #completedJobsTable thead th:nth-child(6),
  #completedJobsTable thead th:nth-child(7) {
    display: none !important;
  }
  /* Hide the corresponding td cells for rows that keep the original full-column layout.
     Mobile rows use the .mobile-row class and should keep their 1st/2nd/3rd tds visible. */
  #completedJobsTable tr:not(.mobile-row) td:nth-child(1),
  #completedJobsTable tr:not(.mobile-row) td:nth-child(5),
  #completedJobsTable tr:not(.mobile-row) td:nth-child(6),
  #completedJobsTable tr:not(.mobile-row) td:nth-child(7) {
    display: none !important;
  }
  /* Make mobile rows visibly clickable */
  #completedJobsTable tr.mobile-row { cursor: pointer; }
}
:root{
  --bg:#f3f4f6; --text:#111111; --muted:#6b7280; --card:#ffffff; --line:#e5e7eb; --accent:#e11d48;
  --folder-bg: linear-gradient(180deg,#fffef5,#ffffff);
  --folder-border: 1px dashed #f3e6c9;
  --folder-blue-bg: linear-gradient(180deg,#f5fbff,#ffffff);
  --folder-blue-border: #bfdbfe;
}

*{box-sizing:border-box}
html,body{margin:0}
.main-header {
  width: 100%;
  background: #fff;
  box-shadow: 0 2px 8px rgba(0,0,0,0.04);
  z-index: 100;
  position: relative;
  min-height: 72px;
  display: flex;
  align-items: center;
  justify-content: center;
}
body{background:var(--bg);color:var(--text);font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;padding-bottom:0}
a{color:inherit;text-decoration:none}
.container{max-width:1200px;margin:0 auto;padding:0 40px}
/* Dashboard-specific override - no max-width for full-width layout */
body:has(main .dashboard-layout) .container,
.dashboard-layout .container,
body:has(main .dashboard-layout) header .container{max-width:100%}
/* Keep footer constrained on dashboard pages so it aligns with the center column */
body:has(main .dashboard-layout) footer.container{
  /* constrain footer to the center column (match calendar/day panels)
     left/right sidebars are 280px each in the dashboard grid, so
     center column width = 100% - 560px */
  width: calc(100% - 560px);
  margin-left: 280px;
  max-width: none;
}

/* General: when footer uses the .container class, keep it boxed to the same
   width as other centered content and ensure matching horizontal padding */
footer.container{
  box-sizing: border-box;
  max-width: 1200px;
  margin: 24px auto 40px; /* small gap above, and bottom spacing */

/* Admin page: mobile-friendly overrides */
@media (max-width: 900px) {
  /* Reduce horizontal padding for small screens */
  .container { padding: 0 12px; }

  .admin-header { font-size: 1.25rem; margin: 12px 0; text-align: left; }

  /* Stack shop cards into a single column */
  #shopList { display: flex; flex-direction: column; gap: 12px; }

  .shop-card {
    display: flex !important;
    flex-direction: column !important;
    padding: 12px !important;
    margin: 12px 0 !important;
    border-radius: 12px !important;
    box-shadow: 0 2px 8px rgba(0,0,0,0.06) !important;
    overflow: visible !important;
  }

  /* Make absolute-positioned badges and buttons flow better on mobile */
  .shop-card > div { position: static !important; width: 100% !important; margin-left: 0 !important; }
  .shop-card .card { width: 100% !important; flex: none !important; margin-left: 0 !important; }

  /* Ensure charts and appointment lists scale to container */
  .shop-card canvas { max-width: 100% !important; height: auto !important; }
  .shop-card h3 { font-size: 1.05rem !important; margin-bottom: 8px !important; }

  /* Make action buttons full width and easier to tap */
  .shop-card .btn { width: 100% !important; box-sizing: border-box; padding: 10px 12px !important; }

  /* Add spacing between stacked inner cards */
  .shop-card .card { margin-top: 10px !important; }

  /* Revenue table: convert to stacked list for readability */
  .revenue-section { margin-top: 18px; overflow: visible; }
  .revenue-table { width: 100%; overflow: auto; }
  .revenue-table table, .revenue-table thead, .revenue-table tbody, .revenue-table tr, .revenue-table td, .revenue-table th { display: block; }
  .revenue-table thead { display: none; }
  .revenue-table tr { display: flex; justify-content: space-between; padding: 10px 8px; border-bottom: 1px solid var(--line); }
  .revenue-table td { display: block; padding: 0; border: none; }

  /* Full-width Add Shop button on mobile */
  #addShopBtn { width: 100% !important; padding: 12px !important; font-size: 16px !important; border-radius: 10px !important; }

  /* Make modals responsive */
  .modal-content { width: 92% !important; max-width: 640px !important; }
  .modal-overlay { padding: 12px !important; }
}

/* Additional fixes: prevent inner admin panels from causing horizontal overflow on small screens */
@media (max-width: 900px) {
  /* Ensure container doesn't allow horizontal scrolling from shop-cards */
  .container { overflow-x: hidden; }

  /* Target the inner flex wrapper that holds the revenue chart + appointments and stack it */
  .shop-card > div > div[style*="margin-left"] {
    display: flex !important;
    flex-direction: column !important;
    gap: 10px !important;
    width: 100% !important;
    min-width: 0 !important;
  }

  /* Make any element with inline min-width or width constraints collapse properly */
  .shop-card [style*="min-width:"] {
    min-width: 0 !important;
    max-width: 100% !important;
    width: 100% !important;
  }

  /* Ensure inner .card elements are full-width and don't overflow */
  .shop-card .card {
    width: 100% !important;
    max-width: 100% !important;
    box-sizing: border-box !important;
    overflow: hidden !important;
  }

  /* Make canvas responsive */
  .shop-card canvas { width: 100% !important; height: auto !important; display: block !important; }

  /* Appointment list should wrap and not expand beyond container */
  .shop-card #apptList-* { max-width: 100%; }
}

/* Strong overrides to fix admin card overflow caused by inline styles */
@media (max-width: 900px) {
  body, html { overflow-x: hidden !important; }
  .container { overflow-x: hidden !important; }

  /* Match elements that use inline width/min-width/flex to force them to collapse */
  .shop-card [style*="min-width:"] {
    min-width: 0 !important;
    max-width: 100% !important;
    width: 100% !important;
  }
  .shop-card [style*="width:340px"] {
    width: 100% !important;
    max-width: 100% !important;
  }
  .shop-card [style*="flex: 0 0 260px"] {
    flex: none !important;
    width: 100% !important;
    max-width: 100% !important;
  }

  /* Reset negative margins used for layout on desktop */
  .shop-card [style*="margin-left:-12px"] {
    margin-left: 0 !important;
    display: flex !important;
    flex-direction: column !important;
    gap: 10px !important;
    width: 100% !important;
  }

  /* Make revenue charts responsive regardless of canvas attributes */
  canvas[id^="revenueChart-"] {
    width: 100% !important;
    height: auto !important;
    max-width: 100% !important;
    display: block !important;
  }

  /* Ensure appointment list doesn't cause overflow */
  .shop-card [id^="apptList-"] {
    max-width: 100% !important;
    overflow: auto !important;
    box-sizing: border-box !important;
  }

  /* Ensure any inline positioned badges don't overflow container */
  .shop-card [style*="position:absolute"] { position: relative !important; right: auto !important; top: auto !important; }
}
  padding-left: 40px;
  padding-right: 40px;
}
/* Header sits above interactive panels on mobile; keep below global modals */
header.top{position:sticky;top:0;background:var(--card);border-bottom:1px solid var(--line);z-index:10010}
.top .row{display:flex;align-items:center;justify-content:space-between;padding:12px 0}
.brand{display:flex;align-items:center;gap:10px}.brand img{height:52px}
nav{display:flex;flex-wrap:nowrap;gap:2px;align-items:center;overflow-x:auto;scrollbar-width:none;}nav::-webkit-scrollbar{display:none;}nav a{padding:8px 8px;border-radius:8px;white-space:nowrap;flex-shrink:0;font-size:14px;} nav a.active, nav a:hover{background:var(--line)}
.btn{display:inline-flex;align-items:center;gap:8px;border:1px solid var(--line);background:var(--card);color:var(--text);padding:10px 14px;border-radius:10px;cursor:pointer;transition:transform .14s ease,box-shadow .14s ease,filter .12s ease}
.btn.primary{background:#f59e0b;border-color:transparent;color:#fff;border-radius:18px;padding-left:18px;padding-right:18px;font-size:1em;min-height:38px}
.btn.danger{background:#b91c1c;border-color:transparent;color:#fff}
/* Info / blue accent used in dark theme */
.btn.info{background:#60a5fa;border-color:transparent;color:#041014}
/* New Appointment and New Invoice buttons: green from logo */
#newAppt {
  background: #10b981 !important;
  color: #fff !important;
  border: none;
  border-radius: 6px !important;
  font-size: 1em;
  min-height: 38px;
  padding: 0 18px;
}
#newInvoice {
  background: #f59e0b !important;
  color: #fff !important;
  border: none;
  border-radius: 6px !important;
  font-size: 1em;
  min-height: 38px;
  padding: 0 18px;
}
/* Ensure floating parts/labor panels appear above the sticky header */
/* Center parts/labor panels on mobile */
#partsModal, #addPartsModal, #laborModal {
  z-index: 10020 !important;
  margin-left: auto;
  margin-right: auto;
  left: 0;
  right: 0;
  position: relative;
  max-width: 100%;
}
}
/* Invoice-specific: orange edit/info button */
#invTable .btn.info,
#prevTable .btn.info {
  background: #f59e0b;
  color: #fff;
}
.btn.info:hover{filter:brightness(.95)}
.btn.small{padding:5px 8px;font-size:13px;min-height:28px}
.icon-btn { padding: 4px !important; gap: 0 !important; min-width: 34px !important; width: 34px !important; height: 34px !important; display: inline-flex !important; align-items: center !important; justify-content: center !important; border-radius: 8px !important; }
.icon-btn svg { margin-left: 0 !important; display: block; width: 14px; height: 14px; }
.btn.quick-create{background:#ffffff;border:2px solid var(--line);color:var(--text);box-shadow:0 4px 8px rgba(0,0,0,0.1), 0 2px 4px rgba(0,0,0,0.06);transition:all 0.2s ease}
.btn.quick-create:hover{transform:translateY(-1px);box-shadow:0 6px 12px rgba(0,0,0,0.15), 0 3px 6px rgba(0,0,0,0.1)}
/* Unified btn hover for consistent interactions across pages */
.btn:hover{transform:translateY(-2px);box-shadow:0 8px 20px rgba(0,0,0,0.08);filter:brightness(.98)}

/* Make the pill-style save button match the .btn hover behavior */
.pill-save{transition:transform .14s ease,box-shadow .14s ease,filter .12s ease}
.pill-save:hover{transform:translateY(-2px);box-shadow:0 8px 20px rgba(0,0,0,0.08);filter:brightness(.98)}
/* Appointment actions 2x2 grid */
.appt-actions-grid{display:grid;grid-template-columns:repeat(2,minmax(68px,1fr));gap:2px;align-items:center}
.appt-actions-grid .btn{width:100%;justify-content:center}

/* Customer actions: align buttons horizontally and vertically */
#custTable .cust-actions{
  display:flex;
  gap:8px;
  align-items:center;
  justify-content:flex-end;
}
#custTable .cust-actions .btn{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  vertical-align:middle;
}

/* Stacked date/time for appointment table cells */
.stacked-datetime{display:flex;flex-direction:column;align-items:flex-start}
.stacked-datetime .dt-date{font-size:0.95em}
.stacked-datetime .dt-time{font-size:0.78em;color:var(--muted)}

/* Sortable headers visual hint */
.sortable { position: relative; }
.sortable::after { content: ""; position: absolute; right: 8px; font-size: 0.8em; }
.sortable.asc::after { content: "▲"; }
.sortable.desc::after { content: "▼"; }
.card{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:16px;margin-bottom:24px}

/* Inventory grid: left-aligned cards in rows of 3, responsive */
.inventory-grid{
  display:grid;
  grid-template-columns:repeat(3, minmax(0, 1fr));
  gap:16px;
  justify-content:start; /* keep panels left aligned */
  align-items:stretch; /* make cards stretch to equal height */
  max-width:1000px; /* keep cards to the left side visually */
  grid-auto-rows: minmax(120px, auto); /* ensure rows have a sensible minimum height */
}
.inventory-card{min-height:92px;display:flex;flex-direction:column;justify-content:space-between;height:100%;margin-bottom:0}

/* Limit the main inventory grid to show at most 3 rows before scrolling internally */
#inventoryGrid.inventory-grid {
  /* Limit to 3 rows (each min 120px) plus gaps between rows; add extra space so rows aren't clipped */
  max-height: calc((120px * 3) + (16px * 2) + 48px); /* ~440px to ensure full visibility */
  overflow-y: auto;
  padding-right: 8px;
  box-sizing: border-box;
}

/* Themed scrollbar for the inventory grid */
#inventoryGrid.inventory-grid::-webkit-scrollbar{ width:10px }
#inventoryGrid.inventory-grid::-webkit-scrollbar-thumb{ background: linear-gradient(180deg, var(--line), rgba(0,0,0,0.12)); border-radius:8px; border:2px solid transparent; background-clip: padding-box; }
.inventory-card .btn{padding:8px 10px;font-size:13px}

/* Folder card specific styling (theme-aware) */
.folder-card{
  background: var(--folder-bg);
  border: var(--folder-border);
}

.folder-card .btn{ background: #f59e0b; color: #fff; border: none }

/* Blue variant for special folders (e.g., Coolant) */
.folder-card.blue{
  background: var(--folder-blue-bg);
  border-color: var(--folder-blue-border);
}
.folder-card.blue .btn{ background: #60a5fa !important; color: #041014 !important; border: none !important }

/* Delete/danger button style */
.btn.danger{background:#ef4444;color:#fff;border:none}
.btn.danger:hover{filter:brightness(.95)}

/* Ensure trash icon in danger buttons is white and nudged right */
.btn.danger svg { stroke: #fff !important; fill: none !important; display: block; margin-left: 6px; }
.btn.danger svg * { stroke: #fff !important; }

/* Left panel activity small items */
#recentOrdered div, #staleOrdered div { padding:6px 0; border-bottom:1px dashed var(--line); }
@media (max-width: 900px) {
  #recentOrdered, #staleOrdered { font-size:13px; }
}

@media (max-width:1100px){
  .inventory-grid{grid-template-columns:repeat(2, minmax(0, 1fr));}
}
@media (max-width:640px){
  .inventory-grid{grid-template-columns:repeat(1, minmax(0, 1fr));}
}

/* Search input styling */
#inventorySearch{border:1px solid var(--line);border-radius:8px;padding:8px;background:var(--card);color:var(--text)}

/* Last order text on card */
.inventory-card .last-order{margin-top:10px;font-size:12px;color:var(--muted)}

/* Slightly separate order button visually */
.inventory-card .btn[aria-label="Order"]{background:#60a5fa;color:#fff;border:none}

/* Make entire card appear clickable with same hover "lift" as .btn */
.card.clickable{cursor:pointer;transition:transform .14s ease,box-shadow .14s ease,filter .12s ease,background .12s ease;position:relative;overflow:hidden}
.card.clickable:hover{transform:translateY(-2px);box-shadow:0 8px 20px rgba(0,0,0,0.08);filter:brightness(.98);background:linear-gradient(180deg, rgba(0,0,0,0.02), rgba(0,0,0,0.01));}

/* Curved top-to-bottom reflection sweep (left-to-right) */
.card.clickable::after{
  content: "";
  position: absolute;
  top: -28%;
  left: -80%;
  width: 280%;
  height: 220%;
  pointer-events: none;
  border-radius: 50% / 20%; /* creates a curved, elliptical band */
  /* metallic silver-blue sweep (visible over white cards): center has cool tint, edges fade */
  background: linear-gradient(90deg,
    rgba(255,255,255,0) 0%,
    rgba(120,140,160,0.08) 14%,
    rgba(200,215,230,0.14) 30%,
    rgba(140,160,180,0.22) 48%,
    rgba(200,215,230,0.12) 66%,
    rgba(110,125,140,0.06) 82%,
    rgba(255,255,255,0) 100%
  );
  transform: translateX(-120%) rotate(-18deg);
  filter: blur(3px) saturate(1.05) contrast(1.02);
  mix-blend-mode: multiply; /* tint the white card for visible metallic sheen */
  opacity: 0;
  will-change: transform, opacity;
  /* Use linear timing so the sweep translates smoothly without pausing */
  animation: reflect-sweep 2.6s linear infinite;
}

@keyframes reflect-sweep{
  0% {
    transform: translateX(-120%) rotate(-18deg);
    opacity: 0;
  }
  12% {
    transform: translateX(-70%) rotate(-18deg);
    opacity: 0.45;
  }
  35% {
    transform: translateX(-35%) rotate(-18deg);
    opacity: 0.75;
  }
  60% {
    transform: translateX(20%) rotate(-18deg);
    opacity: 0.7;
  }
  85% {
    transform: translateX(80%) rotate(-18deg);
    opacity: 0.22;
  }
  100% {
    transform: translateX(120%) rotate(-18deg);
    opacity: 0;
  }
}

/* Hoverable card variant: same lift + grey hover but no reflection sweep */
.card.hoverable{cursor:pointer;transition:transform .14s ease,box-shadow .14s ease,filter .12s ease,background .12s ease}
.card.hoverable:hover{transform:translateY(-2px);box-shadow:0 8px 20px rgba(0,0,0,0.08);filter:brightness(.98);background:linear-gradient(180deg, rgba(0,0,0,0.02), rgba(0,0,0,0.01));}

.grid{display:grid;gap:16px}.grid.cols-2{grid-template-columns:1fr 1fr}.grid.cols-3{grid-template-columns:1fr 1fr 1fr}
label{font-size:13px;color:var(--muted)} input,select,textarea{width:100%;padding:10px 12px;border:1px solid var(--line);border-radius:10px;background:var(--card);color:var(--text);outline:none}
.table{width:100%;border-collapse:collapse}.table th,.table td{border-bottom:1px solid var(--line);padding:10px 8px;text-align:left}

/* Staff Table Mobile Responsiveness */
# Dark theme fix for select dropdowns
@media (prefers-color-scheme: dark) {
  select, select option {
    background: var(--card) !important;
    color: var(--text) !important;
    border-color: var(--line) !important;
  }
}
#staffTable {
  width: 100%;
  border-collapse: collapse;
}

#staffTable th, #staffTable td, #shopOwner { 
  color: var(--text);
}

/* Mobile: Stack columns vertically and make table responsive */
@media (max-width: 768px) {
  #staffTable {
    font-size: 0.9rem;
  }
  
  #staffTable thead {
    display: none;
  }
  
  #staffTable tbody tr {
    display: grid;
    grid-template-columns: auto 1fr;
    gap: 8px 12px;
    padding: 12px;
    margin-bottom: 12px;
    border: 1px solid var(--line);
    border-radius: 8px;
    background: var(--card);
  }
  
  #staffTable td {
    border: none;
    padding: 4px 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
  }
  
  #staffTable td::before {
    content: attr(data-label);
    font-weight: 600;
    font-size: 0.85rem;
    color: var(--muted);
    margin-bottom: 4px;
  }
  
  /* Specific column widths for mobile grid */
  #staffTable td:nth-child(1)::before { content: "Name"; }
  #staffTable td:nth-child(2)::before { content: "Email"; }
  #staffTable td:nth-child(3)::before { content: "Role"; }
  #staffTable td:nth-child(4)::before { content: "Hourly Rate"; }
  #staffTable td:nth-child(5)::before { content: "Actions"; }
}

/* Extra small screens */
@media (max-width: 480px) {
  #staffTable tbody tr {
    grid-template-columns: 1fr;
    gap: 8px;
  }
  
  #staffTable td {
    grid-column: 1;
  }
  
  #staffTable td input[type="number"] {
    width: 100% !important;
    max-width: 100px;
  }
  
  #staffTable button {
    padding: 6px 12px !important;
    font-size: 0.85rem !important;
    white-space: nowrap;
  }
  
  #staffTable td:nth-child(4) {
    display: grid;
    grid-template-columns: 1fr auto;
    gap: 8px;
    align-items: center;
  }
  
  #staffTable td:nth-child(5) button {
    width: 100%;
  }
}
.kpis{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}.kpi{background:var(--card);border:1px solid var(--line);border-radius:12px;padding:12px}
@media (max-width:768px){ .kpis{grid-template-columns:repeat(2,1fr)} }
@media (max-width:768px){ .kpis{grid-template-columns:1fr} }
.badge{display:inline-flex;align-items:center;justify-content:center;padding:6px 12px;border-radius:999px;border:1px solid var(--line);font-size:12px;min-width:85px;text-align:center;white-space:nowrap;height:32px;font-weight:500}
.notification { position: fixed; top: 12px; left: 50%; transform: translateX(-50%); background: #10b981; color: white; padding: 8px 16px; border-radius: 6px; font-size: 14px; font-weight: 500; z-index: 100100; box-shadow: 0 2px 8px rgba(0,0,0,0.15); }
.hidden { display:none; }
.badge.open{background:#fee2e2;color:#991b1b}.badge.scheduled{background:#e0ecff;color:#1e40af}.badge.progress{background:#fef3c7;color:#92400e}.badge.parts{background:#e0e7ff;color:#3730a3}.badge.done{background:#dcfce7;color:#065f46}
/* Color-coded job status select to match badges */
.job-status { padding:6px 8px; border-radius:8px; border:1px solid var(--line); font-size:13px; }
.job-status.status-new { background:#fee2e2; color:#991b1b; }
.job-status.status-scheduled { background:#e0ecff; color:#1e40af; }
.job-status.status-in_progress { background:#fef3c7; color:#92400e; }
.job-status.status-awaiting_parts { background:#e0e7ff; color:#3730a3; }
.job-status.status-completed { background:#dcfce7; color:#065f46; }
/* Navigation notification badge */
.nav-notification{display:inline-flex;align-items:center;justify-content:center;min-width:18px;height:18px;padding:0 6px;border-radius:9px;background:var(--accent);color:#fff;font-size:11px;font-weight:600;margin-left:4px}
.toolbar{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
footer{position:relative;background:var(--card);padding:80px 40px 160px 40px;color:var(--muted);margin-top:40px;margin-bottom:40px;border:1px solid var(--line);border-radius:14px;box-shadow:0 8px 20px rgba(0,0,0,0.04);overflow:visible}

/* Decorative thick lines above and below the footer panel */
footer::before, footer::after{
  content: "";
  position: absolute;
  left: 0;
  width: 100%;
  height: 4px; /* thickness of the lines (thinner) */
  background: var(--line);
  pointer-events: none;
}
/* hide the top line when requested (we'll remove it by setting display:none) */
footer::before{ display: none; }
/* keep the bottom line slightly below the panel */
footer::after{ bottom: -6px; }
.calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:6px}
.day{border:1px solid var(--line);border-radius:10px;min-height: 110px;max-height:140px;padding:6px;position:relative;background:var(--card);cursor:pointer;overflow:hidden;display:flex;flex-direction:column}
.day .date{font-size:11px;color:var(--muted);flex-shrink:0}
.day .dotRow{flex:1;overflow:hidden}
.dot{width:6px;height:6px;border-radius:999px;display:inline-block;margin-right:2px}
.dot.open{background:#ef4444}.dot.scheduled{background:#3b82f6}.dot.progress{background:#f59e0b}.dot.done{background:#10b981}
.tooltip{position:absolute;left:50%;transform:translateX(-50%);bottom:6px;background:#111;color:#fff;padding:6px 8px;border-radius:8px;font-size:12px;display:none;white-space:nowrap}.day:hover .tooltip{display:block}
.notice{font-size:13px;color:var(--muted)} .hidden{display:none}
/* Make form error notices stand out: use for login and other form errors */
.notice.error{color:#b91c1c;font-weight:600}
/* Specific login error element: hide when empty, show bold red when populated */
#loginErr{color:#b91c1c;font-weight:600}
#loginErr:empty{display:none}
/* KPIs centered container */
.kpis-center{display:flex;justify-content:center;margin-bottom:0}.kpis-center .kpis{width:100%}
/* Dashboard 3-column layout for calendar with side panels */
.dashboard-layout{display:grid;grid-template-columns:280px 1fr 280px;gap:20px;align-items:start}
.dashboard-layout:first-of-type{grid-template-columns:280px 1fr 280px}
.sidebar{display:flex;flex-direction:column;gap:12px;width:280px;overflow:hidden;margin:0 auto}
.left-sidebar{margin-right:auto}
.right-sidebar{margin-left:auto}
.sidebar .card{overflow:hidden}
/* Open invoices list: limit to 5 cards before scrolling; card height can be adjusted via --invoice-card-height */
#openInvoicesList{
  display:flex;
  flex-direction:column;
  gap:8px;
  max-height: calc((var(--invoice-card-height,64px) * 5) + (8px * 4));
  overflow-y:auto;
  scrollbar-width: thin; /* Firefox */
  scrollbar-color: var(--line) var(--card);
}

/* Themed WebKit scrollbar for the open invoices panel */
#openInvoicesList::-webkit-scrollbar{ width:10px; }
#openInvoicesList::-webkit-scrollbar-track{ background: transparent; }
#openInvoicesList::-webkit-scrollbar-thumb{ background: linear-gradient(180deg, var(--line), rgba(0,0,0,0.12)); border-radius:8px; border:2px solid transparent; background-clip: padding-box; }
#openInvoicesList::-webkit-scrollbar-thumb:hover{ background: linear-gradient(180deg, var(--line), rgba(0,0,0,0.18)); }
.calendar-center{display:flex;flex-direction:column}
@media (max-width:768px){
  /* Switch dashboard to a single-column flow on narrower screens
     and explicitly order the three panels so the middle column (calendar)
     appears first, the left sidebar (open invoices) second, and the
     right sidebar (quick stats + chart) last. Using flex here simplifies
     ordering across browsers. */
  .dashboard-layout{
    display:flex;
    flex-direction:column;
    gap:16px;
    align-items:stretch;
  }

  /* Ensure each panel stretches full-width in the stacked layout */
  .dashboard-layout > div{ width:100%; max-width:none; margin:0; }

  /* Ordering: middle column (child 2) first, left sidebar second, right sidebar third */
  .dashboard-layout > div:nth-child(2){ order: 1; }
  .dashboard-layout > .left-sidebar{ order: 2; }
  .dashboard-layout > .right-sidebar{ order: 3; }

  /* Make sidebars full width when stacked */
  .sidebar{ width:100%; margin:0 auto; }

  /* Tighten spacing for mobile */
  .dashboard-layout .card{ margin-bottom:12px }
}

/* Reduce global container padding on smaller screens so content can use more horizontal space */
@media (max-width:1200px){
  .container{ padding-left:16px; padding-right:16px; }
  header.top .container{ padding-left:12px; padding-right:12px; }
  main{ padding-left:12px !important; padding-right:12px !important; }
}

/* Mobile: compact calendar cells — keep date numbers, hide chip text, show uniform colored dots */
@media (max-width:480px){
  /* Keep the date number visible and same size */
  .calendar .day .date{ display:block; color:var(--muted); font-size:11px; font-weight:600; }

  /* Hide the textual labels inside chips, keep the colored dots visible */
  .calendar .day .chip span:not(.dot){ display:none !important; }

  /* Flatten chips so they don't reserve extra space */
  .calendar .day .chip{ padding:0; border:0; background:transparent; margin:0; }

  /* Keep dots visible and a little larger on mobile for clarity */
  .calendar .day .dot.big{ width:10px; height:10px; margin-right:6px }

  /* Ensure the dotRow stays in place and centered without changing cell size */
  .calendar .day .dotRow{ margin-top:6px; display:flex; gap:6px; align-items:center; justify-content:flex-start; }

  /* Preserve the calendar cell dimensions so days don't resize */
  .calendar .day{ min-height:110px; max-height:140px; padding:6px; }

  /* Hide the tooltip on very small screens to avoid overlap */
  .calendar .day .tooltip{ display:none !important; }

  /* Hide unwanted columns in appointments table on mobile: show only Dot, Customer, Scheduled, Status */
  #apptTable thead th:nth-child(2),
  #apptTable tbody td:nth-child(2) { display: none; } /* Created Date */

  #apptTable thead th:nth-child(4),
  #apptTable tbody td:nth-child(4) { display: none; } /* Vehicle */

  #apptTable thead th:nth-child(5),
  #apptTable tbody td:nth-child(5) { display: none; } /* Service */

  #apptTable thead th:nth-child(7),
  #apptTable tbody td:nth-child(7) { display: none; } /* Preferred Time */

  #apptTable thead th:nth-child(9),
  #apptTable tbody td:nth-child(9) { display: none; } /* Actions */

  /* Dot column styling on mobile */
  #apptTable td:nth-child(1) { width: 20px; padding: 0; }

  /* Allow Customer column to expand on mobile for combined text */
  #apptTable td:nth-child(3) { max-width: none; }
  #apptTable { table-layout: fixed; }
  #apptTable td:nth-child(3) { width: 40%; } /* Customer */
  #apptTable td:nth-child(6) { width: 35%; } /* Scheduled */
  #apptTable td:nth-child(8) { width: 25%; } /* Status */

  /* Smaller text and tighter spacing on mobile */
  #apptTable td { font-size: 13px; padding: 8px 6px; }
  #apptTable th { font-size: 12px; padding: 8px 6px; }

  /* Make toolbar select fit better on mobile */
  .toolbar select { width: auto; min-width: 120px; max-width: 150px; }

  /* Hide unwanted columns in jobs tables on mobile: show Dot, Customer, Vehicle, Service, Status */
  #jobsTable thead th:nth-child(2),
  #jobsTable tbody td:nth-child(2),
  #awaitTable thead th:nth-child(2),
  #awaitTable tbody td:nth-child(2) { display: none; } /* Job # */

  #jobsTable thead th:nth-child(7),
  #jobsTable tbody td:nth-child(7),
  #awaitTable thead th:nth-child(7),
  #awaitTable tbody td:nth-child(7) { display: none; } /* Assigned To */

  #jobsTable thead th:nth-child(8),
  #jobsTable tbody td:nth-child(8),
  #awaitTable thead th:nth-child(8),
  #awaitTable tbody td:nth-child(8) { display: none; } /* Actions */

  /* Dot column styling on mobile */
  #jobsTable td:nth-child(1), #awaitTable td:nth-child(1) { width: 20px; padding: 0; }

  /* Adjust column widths for jobs tables on mobile */
  #jobsTable, #awaitTable { table-layout: fixed; }
  #jobsTable td:nth-child(3), #awaitTable td:nth-child(3) { width: 25%; } /* Customer */
  #jobsTable td:nth-child(4), #awaitTable td:nth-child(4) { width: 25%; } /* Vehicle */
  #jobsTable td:nth-child(5), #awaitTable td:nth-child(5) { width: 28%; } /* Service */
  #jobsTable td:nth-child(6), #awaitTable td:nth-child(6) { width: 22%; } /* Status */

  /* Smaller text for jobs tables on mobile */
  #jobsTable th,
  #awaitTable th { font-size: 13px; padding: 8px 2px; } /* Tighter headers */
  #jobsTable td,
  #awaitTable td { font-size: 13px; padding: 8px 2px; } /* Tighter data cells */
}

/* Tight mobile fixes for very narrow devices (e.g. iPhone 14 Pro Max viewport ~430px) */
@media (max-width:1200px){
  /* Prevent cards and tables from stretching beyond the viewport */
  .card{ overflow:hidden; word-break:break-word; hyphens:auto; }

  /* Make tables responsive inside cards */
  .card .table, .card table{ width:100%; display:block; overflow-x:auto; }
  .card table thead, .card table tbody, .card table tr{ display:table; width:100%; box-sizing:border-box; }
  .card table{ table-layout:fixed; }
  .card table th, .card table td{ white-space:normal; word-break:break-word; overflow-wrap:anywhere; }

  /* Day details specific tweaks */
  #dayTable { max-width:100%; }
  #dayTable td, #dayTable th { min-width:0; }

  /* Ensure calendar days don't grow horizontally */
  .calendar{ grid-auto-flow:row; }
  .calendar .day{ min-width:0; box-sizing:border-box; }

  /* Remove forced min-width on month label that can push layout */
  #monthLabel{ min-width:0 !important; max-width:60vw; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }

  /* Slightly reduce KPI padding so they fit comfortably */
  .kpi{ padding:10px; }

  /* Cap chart container height to avoid extreme stretching */
  #revenueChartContainer{ height:120px !important; }
  
  /* Hide Time and Actions columns in Day details table on mobile, show toggle column */
  #dayTable thead th:nth-child(1),
  #dayTable tbody td:nth-child(1) { display: none; }

  /* Hide the desktop actions column (7th) on mobile */
  #dayTable thead th:nth-child(7),
  #dayTable tbody td.actions-cell { display: none !important; }

  /* Show the toggle column (8th) on mobile */
  #dayTable thead th:nth-child(8),
  #dayTable tbody td.mobile-toggle-cell { display: table-cell !important; width:40px; }

  /* Ensure the header aligns with visible mobile columns: show a compact label for actions in the last (toggle) column) */
  #dayTable thead th:last-child::after { content: "Actions"; display:inline-block; font-weight:600; font-size:12px; color:var(--muted); }

  /* Style the toggle to float right */
  .mobile-toggle-cell .toggle-actions{ padding:6px 8px; }

  /* Details row styling */
  .appt-details-row td{ background:var(--card); }

  /* Reduce font sizes and paddings inside the Day details panel to avoid crowding */
  #dayDateDisplay { font-size:12px; }
  #dayTable th, #dayTable td { font-size:12px; padding:6px 8px; }
  #dayTable td.actions-cell .btn,
  .appt-details-row td .btn { font-size:12px; padding:6px 8px; }

  /* Make the status badge smaller and tighter inside the day details table */
  #dayTable .badge { font-size:10px; height:18px; min-width:36px; padding:3px 6px; line-height:1.1; }

  /* Tighter button sizing on very narrow screens to reduce crowding */
  .btn { padding:6px 8px; font-size:12px; min-height:32px; border-radius:8px; }
  .btn.btn-sm, .btn.small, .mobile-detail-btn { padding:5px 8px; font-size:12px; min-height:28px; }
  .mobile-toggle-cell .toggle-actions{ padding:4px 6px; font-size:13px; min-width:36px }

  /* Make details row buttons slightly smaller */
  .appt-details-row td .btn { font-size:12px; padding:6px 8px; }

}
/* === EDIT #6: Calendar dot/legend readability & overlap fix === */
.dotRow{display:flex;flex-wrap:wrap;gap:3px;align-items:center;margin-top:2px}
.chip{display:inline-flex;align-items:center;gap:3px;border:0.5px solid var(--line);border-radius:999px;padding:1px 5px;font-size:10px;background:var(--card);transition:all 0.2s ease;white-space:nowrap}
.chip.clickable{cursor:pointer;}
.chip.clickable:hover{background:var(--line);transform:scale(1.05);}
/* Larger pills specifically for Settings page service/labor lists */
#svcList .chip, #labList .chip {
  padding: 6px 12px;
  font-size: 13px;
  gap: 8px;
  border-radius: 14px;
}
  .dot.big{width:8px;height:8px}
  .tooltip{font-size:13px;padding:8px 10px}
  .tooltip.show{display:block}

/* Modal overlay for confirmation dialogs */
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.6);
  backdrop-filter: blur(4px);
  display: flex;
  /* lower modals so they don't collide with the sticky header */
  align-items: flex-start;
  padding-top: 88px;
  justify-content: center;
  z-index: 10020;
  animation: fadeIn 0.2s ease;
}

.modal-overlay.hidden {
  display: none;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.modal-content {
  animation: slideIn 0.3s ease;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
  background: var(--card, #fff);
  color: inherit;
  border-radius: 12px;
  /* Narrower default modal width so dialogs are less wide on desktop */
  width: min(680px, 90vw);
  max-height: 80vh;
  display: flex;
  flex-direction: column;
}

/* Service selection buttons inside the Jobs service modal */
#serviceOptionsContainer .btn {
  width: 100%;
  padding: 12px 14px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  background: var(--card);
  border: 1px solid var(--line);
  border-radius: 10px;
  text-align: left;
  box-shadow: 0 2px 8px rgba(16,24,40,0.04);
  cursor: pointer;
}
#serviceOptionsContainer .btn:hover,
#serviceOptionsContainer .btn:focus {
  transform: translateY(-2px);
  box-shadow: 0 6px 18px rgba(16,24,40,0.08);
  border-color: var(--accent);
}

/* Make the price text slightly muted and compact */
#serviceOptionsContainer .btn span:last-child { color: var(--muted); font-size: 0.95rem; }


/* Make the Folder modal taller and allow its body to scroll so folder items are visible */
#folderModal .modal-content {
  width: min(760px, 92vw);
  max-height: 88vh;
}
#folderModal .modal-content .modal-body{
  max-height: calc(88vh - 88px); /* account for header/footer */
  overflow-y: auto;
}

/* Keep modals centered on small screens where top padding would be intrusive */
@media (max-width: 768px) {
  .modal-overlay { align-items: center; padding-top: 0; }
}

/* Center inventory modal specifically (override default top-offset) */
#inventoryModal.modal-overlay {
  align-items: center;
  padding-top: 0;
}

/* Themed confirm modal to match Jobs green banner */
.modal-overlay.confirm-theme .modal-content .modal-head{
  background: #10b981;
  color: #fff;
  padding: 12px 18px;
  border-top-left-radius: 12px;
  border-top-right-radius: 12px;
}
.modal-overlay.confirm-theme .modal-content .modal-head h2{
  margin:0; font-size:16px;
}
.modal-overlay.confirm-theme .modal-content .modal-body{
  padding: 18px;
}
.modal-overlay.confirm-theme .modal-content .btn.primary{
  background: #10b981 !important;
  color: #fff !important;
  border: none !important;
}
.modal-overlay.confirm-theme .modal-content .btn.danger{
  background: #ef4444 !important;
}

/* Newspaper-style layout for revenue modal */
.rev-newspaper{display:flex;flex-direction:column;gap:12px}
.rev-print-hero{display:flex;flex-direction:column;gap:4px}
.rev-headline{font-family: 'Georgia', serif;font-size:22px;margin:0}
.rev-lead{font-family: 'Georgia', serif;color:var(--muted);font-size:14px}
.rev-columns{display:grid;grid-template-columns:1fr minmax(220px,320px);gap:20px;align-items:start}
.rev-column{font-family: 'Georgia', serif;color:var(--text);line-height:1.45}
.rev-side{background:transparent;padding:0;border:0;border-radius:0;box-sizing:border-box}
.rev-section-title{font-family: 'Georgia', serif;font-weight:700;margin:6px 0}
.rev-list{list-style:none;padding:0;margin:0}
.rev-list li{padding:6px 0;border-bottom:1px solid var(--line);font-size:14px}
.rev-cta-row{display:flex;justify-content:space-between;gap:8px}
/* Small stat cards inside the newspaper modal */
.rev-stats-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:8px}
.rev-stat-card{background:var(--card);border:1px solid var(--line);padding:10px;border-radius:8px;font-family:'Georgia',serif}
.rev-stat-card .label{font-size:12px;color:var(--muted);margin-bottom:6px}
.rev-stat-card .value{font-size:18px;font-weight:800}

/* Make modal body scrollable when content is tall */
.modal-body{overflow:auto;max-height:calc(80vh - 140px);padding:12px}

/* Constrain the right-side panel to avoid overflowing the modal */
.rev-side{max-height:calc(80vh - 220px);overflow:auto}

/* Responsive: stack columns on smaller widths to avoid horizontal overflow */
@media (max-width:780px){
  .rev-columns{grid-template-columns:1fr;}
  .rev-side{max-height:none;overflow:visible}
  .rev-stats-grid{grid-template-columns:repeat(2,1fr)}
}

/* Small helper: two-column lists inside rev-side when space allows */
.rev-side .two-col { display:grid; grid-template-columns:1fr 1fr; gap:12px }
.rev-side .two-col .rev-list{max-height:240px; overflow:auto}

/* Rev-side panel tweaks for compact panels */
.rev-side .rev-panel{background:linear-gradient(180deg,var(--card),#fafafa);padding:10px;border:1px solid var(--line);border-radius:8px;box-sizing:border-box}
.rev-side .rev-panel.rev-mini .rev-list{max-height:160px;overflow:auto;padding-right:6px}

/* General rev-panel styling so panels outside the aside also get card treatment */
.rev-panel{background:linear-gradient(180deg,var(--card),#fafafa);padding:12px;border:1px solid var(--line);border-radius:10px;box-sizing:border-box}
.rev-panel.rev-mini .rev-list{max-height:160px;overflow:auto;padding-right:6px}
.rev-panel .rev-section-title{margin-bottom:8px}
.rev-side .rev-panel .rev-section-title{margin-bottom:8px}

/* Align the aside's top panel so it visually lines up with the left column's weekly panel
   The left column includes a section title above its panel; add a top offset to the
   aside panel so both panels appear level on wider screens. Remove the offset on
   narrow screens where the layout stacks. */
.rev-side .rev-panel { margin-top: 36px; }
@media (max-width:780px) {
  .rev-side .rev-panel { margin-top: 0; }
}

/* Horizontal container for two compact panels in the aside */
.rev-side-inner{display:flex;gap:12px;align-items:flex-start}
.rev-side-inner .rev-panel{min-width:0}
@media (max-width:780px){
  .rev-side-inner{flex-direction:column}
}

/* Panel row placed under Weekly Breakdown */
.rev-panels-row{display:flex;gap:12px;align-items:flex-start}
.rev-panels-row .rev-panel{min-width:0}
@media (max-width:780px){
  .rev-panels-row{flex-direction:column}
}

/* Constrain charts inside revenue modal so they don't expand vertically
   like full-width flexible canvases. The Chart.js instances are created
   with maintainAspectRatio:false so the canvas will fill the container. */
.rev-chart-container{height:160px;max-height:220px;min-height:120px}
.rev-chart-container canvas{width:100%;height:100%;display:block}

/* Styles for the Last 7 days rows inside revenue modal */
.rev-day-row{border-bottom:1px solid var(--line);padding:6px 0}
.rev-day-toggle{display:flex;justify-content:space-between;align-items:center;cursor:pointer;padding:6px;border-radius:6px}
.rev-day-toggle:hover{background:var(--line)}
.rev-day-left{display:flex;align-items:center;gap:8px}
.rev-day-badge{background:var(--line);border-radius:999px;padding:4px 8px;font-weight:700;font-size:12px}
.rev-day-right{display:flex;align-items:center;gap:8px}
.rev-chevron{transition:transform .22s ease;opacity:0.8}
.rev-day-toggle.open .rev-chevron{transform:rotate(180deg)}
.rev-day-details{padding:8px 4px 12px;max-height:0;overflow:hidden;transition:max-height .28s ease,opacity .2s ease;opacity:0}
.rev-day-details.open{opacity:1}
.rev-day-details .table{width:100%;margin:0}
.rev-day-details .table th,.rev-day-details .table td{padding:6px 8px;font-size:13px}

.modal-head {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 14px;
  border-bottom: 1px solid var(--border, #e5e5e5);
}

.modal-body {
  padding: 12px 14px;
}

.modal-foot {
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  padding: 12px 14px;
  border-top: 1px solid var(--border, #e5e5e5);
}

.btn-close {
  position: absolute;
  top: 8px;
  right: 8px;
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  color: var(--text);
  padding: 4px;
  line-height: 1;
}

@keyframes slideIn {
  from { transform: translateY(-20px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}
/* === /EDIT #6 === */

@media print{header.top, footer, nav, .no-print{ display:none !important; } body{ background:#fff; color:#000; } .card{ border:none; box-shadow:none; }}
#invBrand{display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:8px;}
#invBrand .brand-left{ height:48px; } #invBrand .brand-right{ display:flex; align-items:center; gap:8px; } #invBrand .brand-right img{ height:60px; }
.no-screen { display:none; }
@media print{
  .no-screen { display:initial; }
  /* Center and slightly enlarge footer logo for printed invoices so the shop logo is obvious */
  #printFooterLogo{
    position:fixed;
    left:50%;
    transform:translateX(-50%);
    bottom:20px;
    height:28px;
    width:auto;
    display:block;
    /* Keep the footer logo above the page background but ensure content doesn't overlap it. */
    z-index: 1000;
    pointer-events: none;
  }

  /* Reserve room at the bottom of the printed page so long tables don't flow under the footer logo. */
  main.container, .container {
    padding-bottom: 88px !important;
  }
}

/* === EDIT #6b: Calendar tooltip stacking + theme look === */
.day{ overflow: visible; }              /* prevent clipping inside the day box */
.day.tip-open{ z-index: 999; }          /* raise the active day above neighbors */

.tooltip{ 
  z-index: 1000;                        /* ensure it sits above adjacent cells */
  background: var(--card);              /* theme-friendly panel */
  color: var(--text);
  border: 1px solid var(--line);
  border-radius: 10px;
  box-shadow: 0 6px 18px rgba(0,0,0,.18); /* subtle depth, solid colors still */
}

.tooltip::after{                        /* little caret pointer */
  content: "";
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  bottom: -6px;
  border-width: 6px 6px 0 6px;
  border-style: solid;
  border-color: var(--card) transparent transparent transparent;
  /* create a thin outline to match border */
  box-shadow: 0 0 0 1px var(--line);
}
/* === /EDIT #6b === */
/* ================================
   CRMGR2 — Mobile Readability Fixes
   Date: 2025-09-11
   Scope: calendar legend/popover, header/dropdowns,
          buttons hit area, tables, modals
   NOTE: All rules below are surgical and wrapped in media queries
=================================== */

:root {
  /* keep tokens neutral; adjust if you already have them */
  --crmz-layer-popover: 9999;
  --crmz-gap-xs: 6px;
  --crmz-gap-sm: 10px;
}

/* Calendar popover should always float above neighbors */
.crm-popover,
.day-popover,
.calendar-popover {
  z-index: var(--crmz-layer-popover);
}

/* Make any calendar cell a safe stacking context */
.calendar-day,
.day,
.cell,
[data-calendar-day] {
  position: relative;
}

/* Tables: allow horizontal scroll inside their card without breaking layout */
.table-wrapper,
.table-responsive,
.table-container {
  width: 100%;
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
}

/* Large tap targets without re-theming */
button,
.btn,
.button {
  min-height: 44px;
  min-width: 44px;
}

/* Modals: never exceed viewport on mobile */
.modal,
.dialog,
[data-modal] {
  max-height: 90vh;
  overflow: auto;
}

/* Header dropdowns should not clip off-screen */
.header .dropdown,
.navbar .dropdown,
[data-dropdown] {
  max-width: 96vw;
}

/* =======================
   Narrow screens only
======================= */
@media (max-width: 480px) {

  /* Calendar legend: single row that wraps with gaps and bigger dots */
  .calendar-legend,
  .legend,
  [data-calendar-legend] {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: var(--crmz-gap-sm);
    min-height: 38px; /* prevents overlap into grid */
  }

  .calendar-legend .dot,
  .legend .dot,
  [data-calendar-legend] .dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    flex: 0 0 auto;
  }

  .calendar-grid .day,
  .calendar .day,
  .calendar [data-calendar-day],
  [data-calendar-grid] [data-calendar-day] {
    min-height: 86px; /* a touch taller for stacked dots/labels */
  }


  /* Popover: fixed on mobile for safe viewport positioning */
  .day-popover,
  .calendar-popover,
  .crm-popover {
    position: fixed !important;
    left: 12px !important;
    right: 12px !important;
    bottom: 12px !important;
    top: auto !important;
    max-height: 78vh;
    overflow: auto;
    border-radius: 12px;
    box-shadow: 0 8px 28px rgba(0,0,0,.25);
  }

  /* Header: wrap content, avoid horizontal scroll */
  .header,
  .navbar,
  [data-header] {
    display: flex;
    flex-wrap: wrap;
    row-gap: var(--crmz-gap-xs);
  }

  /* Optional compact labels if you use text next to icons */
  .nav .label,
  .navbar .label,
  [data-nav] .label {
    display: none; /* keep icons, drop long labels on tiny screens */
  }

  /* Ensure dropdown menus stay within viewport */
  .dropdown-menu {
    max-width: 96vw;
    overflow-x: auto;
  }

  /* Table readability: soften wrapping and ensure paddings */
  table th, table td {
    padding: 10px 12px;
    white-space: nowrap; /* keep cells tidy; scroll container handles overflow */
  }
}

/* Subtle horizontal scroll affordance for wide tables (non-destructive) */
.table-wrapper::after,
.table-responsive::after {
  content: "↔";
  position: sticky;
  right: 6px;
  bottom: 6px;
  font-size: 12px;
  opacity: .35;
  pointer-events: none;
}

/* === Labor Rate Picker === */
.rate-picker{ position:fixed; inset:auto 20px 20px auto; max-width:640px; background:var(--card); border:1px solid var(--line); border-radius:14px; padding:12px; box-shadow:0 10px 24px rgba(0,0,0,.25); z-index:1000;}
.rate-row{ display:flex; align-items:center; justify-content:space-between; padding:10px 8px; border-radius:10px; cursor:pointer; }
.rate-row:hover{ background:var(--line); }
.rate-actions{ display:flex; gap:8px; }
.rate-small{ font-size:12px; color:var(--muted); }

/* ===== Appointments: compact action buttons ===== */
.appt-actions {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 4px;
  width: 100%;
}

.appt-actions .btn,
.appt-actions button { 
  border-radius: 12px; 
  width: 100%;
  justify-content: center;
  text-align: center;
  padding: 6px 8px !important;
  margin: 0;
  font-size: 0.85rem !important;
  line-height: 1.2 !important;
}

.btn-sm { padding: 6px 10px !important; font-size: 0.9rem !important; line-height: 1.1 !important; }
.btn-danger { background:#c62828; color:#fff; }
.btn-secondary { background:#e9ecef; color:#111; }

/* simple modal visibility toggles (optional if you already have) */
.hidden { display: none; }
.open   { display: block; }

/* Invoices: compact item row */
.item-row{
  display:grid;
  grid-template-columns: 1fr 90px 110px 44px; /* name | qty | price | remove */
  gap:10px;
  align-items:center;
  margin-top:6px;
}
.item-row .itm-qty{ width:100%; }
.item-row .itm-price{ width:100%; }
.itm-remove{
  min-width:44px;
  padding:6px 0;
  display:inline-flex; justify-content:center; align-items:center;
}

/* Invoice item block: meta line above and a subtle separator between items */
.inv-item-block{
  border-top: 1px solid var(--line);
  padding-top: 10px;
  margin-top: 10px;
}
.inv-item-block:first-child{
  border-top: none;
  padding-top: 0;
  margin-top: 0;
}
.inv-item-meta{
  font-size: 13px;
  color: var(--muted);
  margin-bottom: 6px;
}

/* Thinner controls for invoice modal: target a few placement variants so buttons shrink reliably */
#invModal .inv-item-block .itm-remove,
#invModal .item-row .itm-remove,
#invModal .inv-item-block .btn.small,
#invModal .modal-body .btn.small,
#invModal .modal-body .itm-remove,
#invModal .btn.small.inv-short {
  min-width: 28px !important;
  padding: 3px 6px !important;
  font-size: 0.82rem !important;
  line-height:1 !important;
}
#invModal .inv-item-block .itm-remove,
#invModal .item-row .itm-remove {
  padding-left: 6px !important;
  padding-right: 6px !important;
}

/* === Appointments: Service dropdown === */
.svc-toggle{
  display:flex;
  flex-direction:column;
  gap:0px;
  min-height: 32px;
}

/* clickable pill (like your invoice inputs) */
.svc-label{
  display:inline-flex;
  align-items:center;
  gap:8px;
  padding:6px 10px;
  border:1px solid var(--line);
  border-radius:10px;
  background:var(--card);
  cursor:pointer;
  user-select:none;
  line-height:1;
  min-height: 32px;
}

/* caret */
.svc-label::after{
  content:"▾";
  display:inline-block;
  transform:rotate(0deg);
  transition:transform .18s ease;
  transform-origin:50% 45%;
}

/* rotate when open */
.svc-toggle.open .svc-label::after{
  transform:rotate(180deg);
}

/* dropdown panel */
.svc-notes{
  display:none;               /* hidden by default; JS toggles via .open or .hidden */
  padding:10px 12px;
  border:1px solid var(--line);
  border-radius:10px;
  background:var(--card);
  color:var(--muted);
  font-size:13px;
  white-space:pre-wrap;
}

/* show when container has .open */
.svc-toggle.open .svc-notes{
  display:block;
}

/* keep your global helper */
.hidden{ display:none !important; }

/* Hamburger menu button (hidden by default) */
.menu-toggle {
  display: none;
  flex-direction: column;
  justify-content: space-around;
  width: 24px;
  height: 24px;
  background: transparent;
  border: none;
  cursor: pointer;
  padding: 0;
  z-index: 10;
  margin-left: auto;
}

.menu-toggle span {
  display: block;
  width: 100%;
  height: 2px;
  background-color: currentColor;
  border-radius: 3px;
  transition: all 0.3s ease;
}

/* Responsive styles for small screens */
@media (max-width: 768px) {
  .menu-toggle {
    display: flex;
  }
  
  header nav {
    position: fixed;
    top: 60px;
    left: -100%;
    width: 100%;
    background: var(--bg, #fff);
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    transition: left 0.3s ease;
    flex-direction: column;
    padding: 20px;
    z-index: 9;
  }
  
  header nav.active {
    left: 0;
  }
  
  header nav a {
    padding: 10px 14px;
    border-bottom: 1px solid rgba(255,255,255,0.06);
    width: 100%;
    text-align: left;
    font-size: 15px;
    display: block;
  }
  
  /* Hamburger animation when active */
  .menu-toggle.active span:nth-child(1) {
     transform: rotate(45deg) translate(6px, 6px);
     border-radius: 10px;
  }

  .menu-toggle.active span:nth-child(2) {
     opacity: 0;
  }

  .menu-toggle.active span:nth-child(3) {
     transform: rotate(-45deg) translate(6px, -6px);
     border-radius: 10px;
  }

    .menu-toggle.active span {
     transition: all 0.3s cubic-bezier(.4,2,.3,1);
    }
  
  /* Hide or adjust header actions on mobile */
  header .container > div:last-child {
    display: none;
  }

  /* Spread menu links slightly and group special actions */
  header nav { padding: 18px 20px; }
  header nav a { margin-bottom: 8px; border-radius: 8px; }
  header nav a:hover { background: rgba(0,0,0,0.04); }

  /* Theme / Logout special buttons (bigger and separated) */
  .mobile-nav-btn { font-weight:600; border-radius:10px; }
  .mobile-nav-btn + .mobile-nav-btn { margin-top:6px; }
  /* Make theme/logout visually larger and sit below the main links */
  .mobile-nav-btn.mobile-special { padding: 12px 14px; font-size:16px; margin-top:12px; }
  /* If both special buttons exist, ensure they stack nicely */
  .mobile-nav-btn.mobile-special:first-of-type { margin-top:12px; }
}


/* Make action buttons in tables uniform size */
.table td .btn {
  width: 90px;
  padding: 8px 12px;
  text-align: center;
  display: inline-flex;
  justify-content: center;
  align-items: center;
  white-space: nowrap;
  gap: 4px;
  font-size: 13px;
  transition: all 0.2s ease;
}
.table td .btn:hover {
  background: var(--line);
  border-color: var(--muted);
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}
/* Invoice list in sidebar */
#openInvoicesList {
  overflow-y: auto;
  max-height: 400px;
  padding-right: 4px;
}

/* Responsive: 2x2 grid for buttons on small screens */
@media (max-width: 768px) {
  .table td {
    white-space: normal;
  }
  
  .table td:last-child {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 6px;
  }
  
  .table td .btn {
    width: 100%;
    margin: 0;
    text-align: center;
  }
}

/* Appointments table: prevent wrapping to keep dates aligned */
#apptTable td {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

#apptTable td:nth-child(2), /* Customer column */
#apptTable td:nth-child(3), /* Vehicle column */
#apptTable td:nth-child(4) { /* Service column */
  max-width: 180px;
  text-align: left !important;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

#apptTable td:nth-child(4) .svc-toggle {
  max-width: 100%;
}

/* ========================================
   SHOP SWITCHER COMPONENT
   ======================================== */

.shop-switcher {
  position: relative;
  margin-right: 16px;
  display: flex;
  align-items: center;
}

.shop-switcher-btn {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 16px;
  background: rgba(42, 124, 255, 0.1);
  border: 1px solid rgba(42, 124, 255, 0.3);
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s;
  color: var(--text);
  font-size: 14px;
  font-weight: 500;
  white-space: nowrap;
}

.shop-switcher-btn:hover {
  background: rgba(42, 124, 255, 0.2);
  border-color: rgba(42, 124, 255, 0.5);
}

.shop-switcher-btn svg {
  flex-shrink: 0;
}

#currentShopName {
  max-width: 150px;
  overflow: hidden;
  text-overflow: ellipsis;
}

.shop-dropdown {
  position: absolute;
  top: calc(100% + 8px);
  right: 0;
  min-width: 280px;
  max-width: 320px;
  background: var(--card);
  border: 1px solid var(--line);
  border-radius: 12px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.15);
  z-index: 1000;
  overflow: hidden;
}

.shop-dropdown.hidden {
  display: none;
}

.shop-dropdown-loading {
  padding: 24px;
  text-align: center;
  color: var(--muted);
}

.shop-dropdown-header {
  padding: 12px 16px 8px;
  font-size: 11px;
  font-weight: 700;
  text-transform: uppercase;
  color: var(--muted);
  letter-spacing: 0.5px;
}

.shop-dropdown-current {
  padding: 12px 16px;
  background: rgba(42, 124, 255, 0.1);
  font-weight: 600;
  color: var(--accent);
  display: flex;
  align-items: center;
  gap: 8px;
}

.shop-dropdown-current::before {
  content: '✓';
  font-size: 16px;
}

.shop-dropdown-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 16px;
  cursor: pointer;
  transition: background 0.2s;
  color: var(--text);
  text-decoration: none;
  border: none;
  background: none;
  width: 100%;
  text-align: left;
  font-size: 14px;
}

.shop-dropdown-item:hover {
  background: rgba(42, 124, 255, 0.05);
}

.shop-dropdown-item.active {
  background: rgba(42, 124, 255, 0.1);
  font-weight: 600;
  pointer-events: none;
}

.shop-dropdown-item .shop-role {
  font-size: 11px;
  padding: 2px 8px;
  background: rgba(42, 124, 255, 0.2);
  border-radius: 12px;
  color: var(--accent);
  text-transform: capitalize;
}

.shop-dropdown-item.admin-link {
  color: var(--accent);
  font-weight: 600;
}

.shop-dropdown-item.admin-link:hover {
  background: rgba(42, 124, 255, 0.1);
}

.shop-dropdown hr {
  margin: 0;
  border: none;
  border-top: 1px solid var(--line);
}

@media (max-width: 768px) {
  .shop-switcher {
    margin-right: 8px;
  }
  
  .shop-switcher-btn {
    padding: 6px 12px;
    font-size: 13px;
  }
  
  #currentShopName {
    max-width: 100px;
  }
  
  .shop-dropdown {
    min-width: 240px;
  }
}

/* ==================== PARTS CATALOG STYLES ==================== */

.parts-results {
  margin-top: 1.5rem;
  max-height: 500px;
  overflow-y: auto;
}

.parts-list {
  display: grid;
  gap: 1rem;
  grid-template-columns: 1fr;
}

.part-card {
  background: var(--card);
  border: 1px solid var(--line);
  border-radius: 8px;
  padding: 1rem;
  transition: all 0.2s ease;
}

.part-card:hover {
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  border-color: var(--accent);
}

.part-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 0.75rem;
}

.part-header h4 {
  margin: 0;
  font-size: 1rem;
  color: var(--text);
}

.part-header .badge {
  padding: 0.25rem 0.75rem;
  background: var(--accent);
  color: white;
  border-radius: 12px;
  font-size: 0.75rem;
  font-weight: 600;
}

.part-details {
  margin-bottom: 0.75rem;
}

.part-details p {
  margin: 0.25rem 0;
  font-size: 0.9rem;
  color: var(--muted);
}

.part-details strong {
  color: var(--text);
}

.vehicle-fit {
  color: var(--accent) !important;
  font-weight: 500 !important;
  font-size: 0.85rem !important;
}

.part-actions {
  display: flex;
  gap: 0.5rem;
  justify-content: flex-end;
}

.empty-state {
  text-align: center;
  padding: 3rem 1rem;
  color: var(--muted);
}

.loading-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem 1rem;
  color: var(--muted);
}

.spinner {
  width: 40px;
  height: 40px;
  border: 4px solid var(--line);
  border-top-color: var(--accent);
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin-bottom: 1rem;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

.pricing-summary {
  background: #f0f9ff;
  padding: 1rem;
  border-radius: 8px;
  margin-top: 1rem;
}

[data-theme="dark"] .pricing-summary {
  background: rgba(59, 130, 246, 0.1);
}

.form-section {
  margin-bottom: 1.5rem;
}

.form-section h4 {
  margin: 0 0 1rem 0;
  font-size: 1rem;
  color: var(--text);
}

.form-grid {
  display: grid;
  gap: 1rem;
}

@media (max-width: 768px) {
  .form-grid {
    grid-template-columns: 1fr !important;
  }
  
  .parts-results {
    max-height: 400px;
  }
}

/* Modal overlay for pricing modal */
.modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.5);
  z-index: 1000;
  display: none;
}

.modal.active, .modal[style*="display: flex"] {
  display: flex !important;
  align-items: center;
  justify-content: center;
}

/* Messages page mobile header/menu tweaks
   - Hide header theme/logout buttons on mobile (use mobile nav links instead)
   - Ensure the mobile dropdown/nav appears above fixed message panels
*/
@media (max-width: 900px) {
  #themeToggle, #logoutBtn { display: none !important; }
  /* When mobile menu is active, make it a fixed dropdown above panels */
  #mainNav.active {
    position: fixed;
    top: 56px;
    left: 0;
    right: 0;
    z-index: 9999; /* above message panels (z-index:80) but below modal backdrop (99999) */
    background: var(--card);
    padding: 12px 18px;
    box-shadow: 0 12px 30px rgba(2,6,23,0.14);
    border-bottom: 1px solid var(--line);
  }
  /* Ensure the nav links stack nicely inside the dropdown */
  #mainNav.active a { display: block; padding: 10px 12px; border-radius:8px; margin-bottom:6px; }
}

/* Force parts catalog modal above all headers */
#partsCatalogModal {
  z-index: 30000 !important;
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  width: 100vw !important;
  height: 100vh !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
}
#partsCatalogModal .modal-content {
  z-index: 30001 !important;
  position: relative !important;
}
#partsCatalogModal .modal-close {
  z-index: 30002 !important;
  position: absolute !important;
  top: 12px !important;
  right: 12px !important;
}

/* Mobile: make parts catalog behave like other modals (centered card with inner scrolling) */
@media (max-width: 768px) {
  #partsCatalogModal {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 100vw !important;
    height: 100vh !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    padding: 0 12px !important;
    background: rgba(0,0,0,0.35) !important;
  }
  #partsCatalogModal .modal-content {
    width: min(92vw, 640px) !important;
    max-height: calc(90vh) !important;
    overflow: hidden !important;
    border-radius: 12px !important;
    box-shadow: 0 10px 30px rgba(0,0,0,0.25) !important;
  }
  #partsCatalogModal .modal-body {
    max-height: calc(80vh - 120px) !important;
    overflow: auto !important;
    padding: 12px 14px !important;
  }
  #partsCatalogModal .modal-close { top: 8px !important; right: 8px !important; }
}

/* Extra-high-specificity override to ensure centering and dim background on mobile
   (addresses any conflicting inline or page-specific rules). */
@media (max-width: 768px) {
  body > #partsCatalogModal {
    position: fixed !important;
    inset: 0 !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    background: rgba(0,0,0,0.5) !important;
    padding: 12px !important;
    z-index: 40000 !important;
  }

  body > #partsCatalogModal .modal-card {
    width: min(92vw, 720px) !important;
    max-height: calc(90vh) !important;
    margin: 0 auto !important;
    overflow: hidden !important;
    border-radius: 12px !important;
    box-shadow: 0 10px 30px rgba(0,0,0,0.35) !important;
    transform: translateX(8vw) !important; /* nudge right on small screens */
  }

  body > #partsCatalogModal .modal-card .modal-body {
    max-height: calc(80vh - 120px) !important;
    overflow: auto !important;
    -webkit-overflow-scrolling: touch !important;
  }
}

/* ========================================
   Supplier & Dealership Grid Styles
   ======================================== */

.supplier-links-container {
  display: grid !important;
  grid-template-columns: repeat(2, 1fr) !important;
  gap: 16px !important;
  margin-top: 8px;
  width: 100% !important;
  max-width: none !important;
  min-width: 0 !important;
}

.supplier-link-card {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 16px;
  padding: 20px;
  border: 1px solid var(--border, #e5e5e5);
  border-radius: 12px;
  cursor: pointer;
  transition: all 0.2s ease;
  background: var(--card, #fff);
  min-height: 140px;
}

.supplier-link-card:hover {
  background: var(--hover, #f5f5f5);
  border-color: var(--primary, #0066cc);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.supplier-logo-wrapper {
  width: 100px;
  height: 100px;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  border-radius: 10px;
  background: #fff;
}

.supplier-logo {
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
}

.supplier-fallback-icon {
  font-size: 2.5rem;
}

.supplier-name {
  font-size: 1.1rem;
  font-weight: 600;
  text-align: center;
  color: var(--text, #333);
  line-height: 1.3;
}

/* Mobile responsive */
@media (max-width: 768px) {
  .supplier-links-container {
    grid-template-columns: repeat(2, 1fr) !important;
    gap: 12px !important;
  }
  
  .supplier-link-card {
    padding: 12px;
    min-height: 100px;
  }
  
  .supplier-logo-wrapper {
    width: 60px;
    height: 60px;
  }
  
  .supplier-name {
    font-size: 0.9rem;
  }
}

/* Very small screens - single column */
@media (max-width: 480px) {
  .supplier-links-container {
    grid-template-columns: 1fr !important;
  }
}

/* Staff claimed/assigned row highlight */
tr.staff-claimed {
  background-color: rgba(16, 185, 129, 0.12) !important;
}
tr.staff-claimed:hover {
  background-color: rgba(16, 185, 129, 0.2) !important;
}

/* Staff Jobs Page: Hide action buttons on mobile (use modal instead) */
@media (max-width: 768px) {
  #jobsTable .appt-actions-grid,
  #awaitTable .appt-actions-grid {
    display: none !important;
  }
  #jobsTable th:last-child,
  #jobsTable td:last-child,
  #awaitTable th:last-child,
  #awaitTable td:last-child {
    display: none !important;
  }
  /* Also hide Job ID column on mobile for staff jobs */
  #jobsTable th:nth-child(2),
  #jobsTable td:nth-child(2),
  #awaitTable th:nth-child(2),
  #awaitTable td:nth-child(2) {
    display: none !important;
  }
  /* Hide Assigned To column on mobile (always "You" for staff) */
  #jobsTable th:nth-child(7),
  #jobsTable td:nth-child(7),
  #awaitTable th:nth-child(7),
  #awaitTable td:nth-child(7) {
    display: none !important;
  }
}
